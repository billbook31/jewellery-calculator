<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blog - Jewellery Calculator</title>
<style>
body {
  font-family: Poppins, sans-serif;
  background: #f8f9fa;
  margin: 0;
  padding: 20px;
  color: #333;
  text-align: center; /* Center align text for the whole body */
}
.container {
  max-width: 900px;
  margin: auto;
}
h2 {
  text-align: center;
  color: #b8860b;
}
.blog-card {
  background: #fff;
  padding: 15px;
  border-radius: 10px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  margin-bottom: 20px;
}
.blog-card h3 {
  color: #b8860b;
  margin-bottom: 10px;
}
.blog-card p {
  line-height: 1.6;
}
.footer {
  text-align: center;
  margin-top: 40px;
  font-size: 14px;
  color: #777;
}
.ad-section {
  background: #e0f7fa;
  text-align: center;
  border-radius: 8px;
  padding: 12px;
  margin: 15px 0;
  font-weight: bold;
  font-size: 16px;
  border: 2px dashed #00bcd4;
  min-height: 90px;
}
</style>
</head>
<body>
<div class="container">
  <h2>Jewellery Blog & Updates</h2>
  <div class="ad-section" id="topBlogAd">
    <!-- Ad will be loaded here -->
    Your Ad Here
  </div>
  <div id="blogContainer">
    <!-- Blog posts will appear here -->
  </div>
  <div class="footer">
    Â© 2025 Jewellery Calculator | All Rights Reserved
  </div>
</div>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
<script src="firebase-init.js"></script> <!-- Your centralized Firebase config -->

<script>
document.addEventListener('DOMContentLoaded', function() {
  const db = firebase.firestore();
  const container = document.getElementById("blogContainer");

  // Fetch and display blog posts
  db.collection('blogs').orderBy('date', 'desc').onSnapshot(snapshot => {
    if (snapshot.empty) {
      container.innerHTML = '<p>No blog posts available at the moment. Please check back later.</p>';
      return;
    }

    let html = '';
    snapshot.forEach((doc, index) => {
      const blog = doc.data();
      html += `
        <div class="blog-card">
          <h3>${blog.title}</h3>
          <small><i>Published on: ${blog.date}</i></small>
          <p style="text-align: left;">${blog.content}</p>
        </div>`;
      
      // Insert an ad after every 2 blog posts
      if ((index + 1) % 2 === 0 && index < snapshot.size - 1) {
        html += `<div class="ad-section">Your Ad Here</div>`;
      }
    });
    container.innerHTML = html;
  }).catch(error => {
    console.error("Error fetching blogs: ", error);
    container.innerHTML = '<p>Could not load blog posts. Please try again later.</p>';
  });

  // Dynamically load AdSense script using config from Firebase
  db.collection('config').doc('live').get().then(doc => {
      if (doc.exists && doc.data().adsense_client_id) {
          const adsenseId = doc.data().adsense_client_id;
          const script = document.createElement('script');
          script.async = true;
          script.src = `https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${adsenseId}`;
          script.crossOrigin = 'anonymous';
          document.head.appendChild(script);
          console.log('AdSense script loaded for client:', adsenseId);
      } else {
        console.log('AdSense Client ID not found in config.');
      }
  });
});
</script>
</body>
</html>